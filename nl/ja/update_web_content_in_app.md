---

copyright:
  years: 2018, 2019
lastupdated: "2019-06-06"

keywords: update web content, update apps

subcollection:  mobilefoundation
---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:note: .note}
{:tip: .tip}
{:pre: .pre}
{:codeblock: .codeblock}
{:screen: .screen}

# ダイレクト・アップデート
{: #direct_update}

Cordova アプリケーションまたは Ionic アプリケーションの Web リソース (JavaScript、HTML、CSS、またはイメージ・ファイル) は、ユーザーが App Store または Play Store の更新を行う必要なしに、**ダイレクト・アップデート**によって無線で更新されることが可能です。 ダイレクト・アップデート機能を使用して、企業はそのアプリケーションの最新バージョンをエンド・ユーザーが確実に使用するようにすることができます。 アプリケーションを更新するには、アプリケーションの更新された Web リソースをパッケージ化して Mobile Foundation インスタンスにアップロードする必要があります。Mobile Foundation CLI を使用するか、生成されたアーカイブ・ファイルをデプロイすることで、これを行うことができます。 ダイレクト・アップデートはその後、自動でアクティブになります。 そして、保護リソースへのすべてのユーザー要求に適用されます。

![ダイレクト・アップデートの仕組みの図](images/internal_function.jpg)

ダイレクト・アップデートは、Cordova iOS および Cordova Android のプラットフォームでサポートされます。
{: note}

実際の実動または実動前テストのフェーズの場合、アプリケーションをアプリケーション・ストアに公開する前に、セキュアなダイレクト・アップデートを実装することをお勧めします。 セキュアなダイレクト・アップデートでは、実際の CA 署名サーバー証明書から抽出される RSA 鍵ペアが必要です。

1. アプリケーションの公開後に鍵ストア構成を変更しないように注意してください。 新しい公開鍵でアプリケーションを再構成し、アプリケーションを再公開するまで、ダウンロードされた更新を認証することはできません。 この 2 つのステップを実行しないと、クライアントでダイレクト・アップデートが失敗します。
2. ダイレクト・アップデートは、アプリケーションの Web リソースのみを更新します。 ネイティブ・リソースを更新するには、新しいアプリケーション・バージョンを該当アプリケーション・ストアに送信する必要があります。
3. ダイレクト・アップデート機能を使用し、かつ Web リソース・チェックサム機能が使用可能になっていると、新規のチェックサム・ベースが各ダイレクト・アップデートで確立されます。
4. Mobile Foundation サーバーは、アップグレードされた場合、引き続きダイレクト・アップデートを適切に処理します。 ただし、最近ビルドされたダイレクト・アップデート・アーカイブ (.zip ファイル) がアップロードされた場合、古いクライアントへのアップデートを一時停止することがあります。 これは、アーカイブにそのバージョンの `cordova-plugin-mfp` プラグインが含まれるためです。 このアーカイブをモバイル・クライアントに提供する前に、サーバーはクライアントのバージョンをプラグインのバージョンと比較します。 2 つのバージョンが十分に近い (3 つの最上位桁が同じである) 場合、ダイレクト・アップデートは正常に行われます。 それ以外の場合、Mobile Foundation サーバーは何もメッセージを出さずに更新をスキップします。 バージョンの不一致の 1 つの解決策は、元の Cordova プロジェクトにあるものと同じバージョンの `cordova-plugin-mfp` をダウンロードし、ダイレクト・アップデート・アーカイブを再生成することです。
{: tip}

ダイレクト・アップデート後、アプリケーションは、事前にパッケージされた Web リソースを使用しなくなります。 代わりに、アプリケーションのサンドボックスからダウンロードされた Web リソースを使用します。 デバイス上のアプリケーションのキャッシュが消去されると、パッケージされた元の Web リソースが再度使用されます。

Web リソースのダイレクト・アップデートは、アプリケーションの特定バージョンにのみ適用されます。 例えば、アプリケーション・バージョン 2.0 用に生成されたアップデートは、同じアプリケーションのバージョン 2.1 には配信されません。
{: note}

## 更新された Web リソースの作成とデプロイ
{: #creating_deploying_updates}

Web リソースを変更した後、Mobile Foundation CLI を使用して、それらをパッケージ化して Mobile Foundation インスタンスにアップロードできます。

1.  ダイレクト・アップデートは、アプリケーションの Web リソースに対してのみ更新を行います。 ネイティブ・リソースを更新するには、新しいアプリケーション・バージョンを該当アプリケーション・ストアに送信する必要があります。
2. Mobile Foundation サービスは、アプリケーションのネイティブ部分が Mobile Foundation サービスにアップロードされたものと大きく異なる場合は、クライアントへのダイレクト・アップデートを停止します。 これは、*cordova-plugin-mfp* が、プラグインの新しいバージョンで更新された場合に発生する可能性があります。 このアーカイブをモバイル・クライアントに提供する前に、サーバーはクライアントのバージョンをプラグインのバージョンと比較します。 2 つのバージョンが十分に近い (つまり、バージョン ID の最上位 3 桁が同じである) 場合、ダイレクト・アップデートは正常に行われます。 それ以外の場合、Mobile Foundation サーバーは何もメッセージを出さずに更新をスキップします。 バージョンの不一致の 1 つの解決策は、元の Cordova プロジェクトにあるものと同じバージョンの *cordova-plugin-mfp* をダウンロードし、ダイレクト・アップデート・アーカイブを再生成することです。
{: tip}

1. コマンド・ライン・ウィンドウを開き、Cordova プロジェクトのルートに移動します。
2. 次のコマンドを実行します。
  ```bash
  mfpdev app webupdate
  ```
  `mfpdev app webupdate` コマンドにより、更新された Web リソースが `.zip` ファイルにパッケージされ、開発者ワークステーション上で稼働しているデフォルトの Mobile Foundation サーバーにアップロードされます。 パッケージ化された Web リソースは、`[cordova-project-root-folder]/mobilefirst/` フォルダー内にあります。

アプリケーション内の Web コンテンツを更新するための代替手順については、[ここ](/docs/services/mobilefoundation?topic=mobilefoundation-alternate_steps_to_update_app_web_content_in_app#alternate_steps_to_update_app_web_content_in_app)を参照してください。

## ダイレクト・アップデートの拡張構成
{: #direct_update_advanced_config}

ダイレクト・アップデートの拡張構成に関するトピックについては、[ここ ](/docs/services/mobilefoundation?topic=mobilefoundation-advanced_direct_update_configuration#advanced_direct_update_configuration)を参照してください。
